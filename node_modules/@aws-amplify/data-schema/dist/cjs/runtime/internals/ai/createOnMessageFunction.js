'use strict';

// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
// SPDX-License-Identifier: Apache-2.0
Object.defineProperty(exports, "__esModule", { value: true });
exports.createOnMessageFunction = void 0;
const custom_1 = require("../operations/custom");
const convertItemToConversationMessage_1 = require("./convertItemToConversationMessage");
const getCustomUserAgentDetails_1 = require("./getCustomUserAgentDetails");
const createOnMessageFunction = (client, modelIntrospection, conversationId, conversationRouteName, getInternals) => (handler) => {
    const { conversations } = modelIntrospection;
    // Safe guard for standalone function. When called as part of client generation, this should never be falsy.
    if (!conversations) {
        return {};
    }
    const subscribeSchema = conversations[conversationRouteName].message.subscribe;
    const subscribeOperation = (0, custom_1.customOpFactory)(client, modelIntrospection, 'subscription', subscribeSchema, false, getInternals, (0, getCustomUserAgentDetails_1.getCustomUserAgentDetails)(getCustomUserAgentDetails_1.AiAction.OnMessage));
    return subscribeOperation({ conversationId }).subscribe((data) => {
        handler((0, convertItemToConversationMessage_1.convertItemToConversationMessage)(data));
    });
};
exports.createOnMessageFunction = createOnMessageFunction;
//# sourceMappingURL=createOnMessageFunction.js.map
